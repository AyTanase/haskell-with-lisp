(defmodule Common)

(data NFA (or Finite (Compare Char NFA) (Split NFA NFA)))

(instance (Show NFA) ()
  (show (const "#<NFA>")))

(deftype Node (-> NFA NFA))

(deftype (BinOp a) (-> a a a))

(type split (BinOp Node))
(define (split f g x) (Split (f x) (g x)))

(type safeTail (-> (list a) (Maybe (list a))))
(define (safeTail nil) Nothing)
(define (safeTail xs) (Just (tail xs)))
